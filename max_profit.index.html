<!DOCTYPE html>
<html>
<head>
  <title>Mars Land Max Profit</title>
</head>
<body>

  <h2>Mars Land Max Profit Calculator</h2>

  <label>Total Time Units:</label>
  <input id="timeInput" type="number" value="49" min="1" />
  <button onclick="calculateProfit()">Calculate</button>

  <div id="result" style="margin-top:20px;"></div>

  <script>
    class MarsLandProfitAll {
      constructor(totalTime) {
        this.totalTime = totalTime;
        this.buildings = [
          { type: 'T', time: 5, earning: 1500 },
          { type: 'P', time: 4, earning: 1000 },
          { type: 'C', time: 10, earning: 3000 }
        ];
        this.dp = [];
        this.choices = [];
        for (let i = 0; i <= totalTime; i++) {
          this.dp[i] = 0;
          this.choices[i] = [];
        }
      }

      calculate() {
        for (let t = this.totalTime - 1; t >= 0; t--) {
          let maxEarn = this.dp[t];
          let bestChoices = [];

          for (let i = 0; i < this.buildings.length; i++) {
            let b = this.buildings[i];
            let finish = t + b.time;

            if (finish <= this.totalTime) {
              let earn = (this.totalTime - finish) * b.earning + this.dp[finish];

              if (earn > maxEarn) {
                maxEarn = earn;
                bestChoices = [b.type];
              } else if (earn === maxEarn) {
                if (!bestChoices.includes(b.type)) {
                  bestChoices.push(b.type);
                }
              }
            }
          }
          this.dp[t] = maxEarn;
          this.choices[t] = bestChoices;
        }
      }

      backtrack(time = 0, path = [], allPaths = []) {
        if (time >= this.totalTime) {
          allPaths.push(path.slice());
          return;
        }

        if (!this.choices[time] || this.choices[time].length === 0) {
          allPaths.push(path.slice());
          return;
        }

        for (let i = 0; i < this.choices[time].length; i++) {
          let bType = this.choices[time][i];
          let bTime = 0;

          for (let j = 0; j < this.buildings.length; j++) {
            if (this.buildings[j].type === bType) {
              bTime = this.buildings[j].time;
              break;
            }
          }

          path.push(bType);
          this.backtrack(time + bTime, path, allPaths);
          path.pop();
        }
      }

      sequencesToCounts(sequences) {
        let uniqueCounts = [];
        let seen = {};

        for (let seq of sequences) {
          let counts = { T: 0, P: 0, C: 0 };
          for (let b of seq) counts[b]++;
          let key = `T${counts.T}P${counts.P}C${counts.C}`;
          if (!seen[key]) {
            seen[key] = true;
            uniqueCounts.push(counts);
          }
        }
        return uniqueCounts;
      }

      getAllMaxProfitSolutions() {
        this.calculate();

        let allSequences = [];
        this.backtrack(0, [], allSequences);

        let uniqueCounts = this.sequencesToCounts(allSequences);

        return {
          maxEarnings: this.dp[0],
          solutions: uniqueCounts
        };
      }
    }

    function calculateProfit() {
      let input = document.getElementById('timeInput').value;
      let time = parseInt(input);

      let resultDiv = document.getElementById('result');
      resultDiv.innerHTML = '';

      if (isNaN(time) || time <= 0) {
        resultDiv.innerHTML = 'Please enter a positive number.';
        return;
      }

      let marsProfit = new MarsLandProfitAll(time);
      let result = marsProfit.getAllMaxProfitSolutions();

      let html = `<p><b>Max Earnings:</b> $${result.maxEarnings}</p>`;
      html += `<p><b>Number of Solutions:</b> ${result.solutions.length}</p>`;
      html += `<p><b>Building combinations:</b></p><ul>`;

      for (let sol of result.solutions) {
        html += `<li>T: ${sol.T}, P: ${sol.P}, C: ${sol.C}</li>`;
      }
      html += '</ul>';

      resultDiv.innerHTML = html;
    }
  </script>

</body>
</html>
